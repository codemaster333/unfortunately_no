<!DOCTYPE html>
<!-- saved from url=(0022)http://127.0.0.1:5000/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Intuit on 'Fakebook'</title>
<meta name="description" content="Intuit on &#39;Fakebook&#39; Fakebook - create a fictional social profile at www.classtools.net">
<meta name="keywords" content="fakebook,fake,profile,classtools,Intuit on &#39;Fakebook&#39;">
<meta charset="utf-8">
<style>
.share-button { margin: auto; position: absolute; top: 0; left: 0; bottom: 0; right: 0; z-index: 100; }
@charset "UTF-8";
/* CSS Document */


.likeBar
{
border-top: 1px solid #EBEBEB;
color:#4E5665;
font-size:11px;
border-bottom: 1px solid #EBEBEB;
margin-top:10px;
padding:10px 0 9px 5px;
}
.likeBarCom
{
border-top: 1px solid #EBEBEB;
color:#4E5665;
font-size:11px;
text-align:left;
position:relative;
width:466px;
float:right;
}


.ui-widget {
    font-size: 10px; /* Adjusts standard Jquery UI for drop-down autoselect */
}

#advert2 {
	position:relative;
z-index:9999 !important;
}

#advert4 {
position:relative;
z-index:9997 !important;
}

#advert2{
top:-7px;
}
.vidFrame{
position:relative;
z-index:9998 !important;	
}

.pName{
font-weight:bold;
color:#3B5998;
font-size:12px;
}
.pDate{
color:grey;
font-size:11px;
}
.pText{
color:#37404E;
font-size:13px;
}


body{
	position:relative;
	z-index:0;
	font: normal 16px/1.5em;
	overflow-y: scroll;
	background:#E9EAED;
	font-family: 'lucida grande',tahoma,verdana,arial,sans-serif;
	padding-bottom:200px;
	}
a:link {text-decoration:none;color:#3b5998}
a:visited {text-decoration:none;}
a:hover {text-decoration:underline;}
a:active {text-decoration:underline;}


#profileName
{
    color: white;
	font-size:x-large;
	min-width:50px;
	font-weight:bold;
   	left: 10px;
	top: 265px;
    position: relative;
	border 1px black;
	cursor: hand; cursor: pointer;
	text-shadow: 2px 4px 3px rgba(0,0,0,0.8);
	z-index:500;
}

#profileNmText
{
position:relative;	
}

#profileImg{
	position:relative;
	top:140px;
	left:5px;
	width:160px;
	height:160px;
	background:yellow;	
	color:black;
	z-index:1
	}

.blueBtn a:link {color:white}
.redBtn a:link, {color:white}
.blueBtn, .redBtn, .saveBtn {
	font-family: Arial, Helvetica, sans-serif;
	font-size: 12px;
	font-weight:bold;
	color:white;
	float:right;
	margin:3px;
	padding:3px;
	border:1px solid black;
	cursor:pointer;cursor:hand;
	-webkit-border-radius: 2px;
-moz-border-radius: 2px;
border-radius: 2px;
}
.blueBtn{
background:#4e69e2;	
}
.redBtn{
background:red;	font-weight:bold;
}


.saveBtn, saveBtn a:link
{
font-size: 18px;
background-color:yellow;
color:red;	
}

#blockDiv{
    position: fixed;
    left: 0;
    top: 0px;
    min-height: 99%;
    width: 865px;
	zoom: 1;
	background:white;
	filter: alpha(opacity=1);
	opacity: 0.01;
	z-index: 5000;
}


#leftWrapper{
	position:relative;
	padding:0px;
	width:325px;
}


#addNewBlock
{
display:inline-block;
clear:both;
background:white;
border:1px solid grey;
text-align:center;
font-size:large;
font-weight:bold;	
width:320px;
}

hr
{
border: 0;
height: 0;
border-top: 1px solid rgba(0, 0, 0, 0.1);
border-bottom: 1px solid rgba(255, 255, 255, 0.3);
}



img
{
float:left;
margin:5px;
cursor:pointer;cursor:hand;
}

.deleteCross
{
position:relative;
right:0px;
top:0px;
float:right;
}

#blocks
{
position:relative;
left:0px;
}

.leftBox {
	position:relative;
	width:320px;
	padding:1px;
	margin-right:10px;
	min-height:150px;
	float:left;
	background:#fff;
	margin-bottom:15px;
}

.leftImg
{
max-height:100px;
max-width:100px;
position:absolute;
top:-5px;
left:-5px;
}

.leftBoxElement{
	display: inline-block;
	width:100px;
	height:100px;
	background:grey;
	border:1px black solid;
	margin-top:2px;margin-bottom:3px;
	margin-left:1px;
	position:relative;
	padding:0px;
	max-width:100px;
	max-height:100px;
	}
	
.leftBoxText{
	position:absolute;
	bottom:0px;
	left:0px;
	color:white;
	font-size:small;
	width:100%;
	background:black;
}

.leftBoxTitle, .aboutTitle{
	background:#F6F7F8;
	padding:0px;
	padding-top:10px;
	font-size:small;
	font-weight:bold;
	color:grey;
	border-bottom: 1px solid #E9EAED;
	width:100%;
	height:35px;
	margin:0px;
}

#mainArea, #rightBar {
	padding: 10px 0;
	float:left;
	}

#mainArea {
	position:absolute;
	margin-left:335px;
	top:400px;
	width:515px;
	margin-right:20px;
	background:#e9eaed;
	margin-top:0px;
	padding:0px;
}





	
.postImg
{
max-height:45px;
max-width:45px;
background:#e9eaed;	
}

.comImg
{
max-height:33px;
max-width:33px;
background:#e9eaed;	
}


	#overlay {
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 999;
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    display: none;
}

	
#sortable
{
display:inline-block;	
}
.stat{
	padding:0px;
	background:white;
	margin-top:10px;
	cursor:move;
	display: inline-block;
	width:99%;
	border:1px solid #CACACA;
	-webkit-border-radius: 3px;
-moz-border-radius: 3px;
border-radius: 3px;
	}
	

#container {
	position:relative;
	z-index:0;
	width:1010px;
	padding-right:205px;
	}


#rightBar {
	background:#e9eaed;
	position:absolute;
	top:35px;
	padding:10px;
	margin-left:850px;
}

#fixedRight{
	position:absolute;
	height:100%;
	right:0px;
	top:0px;
	width:200px;	
	background:#eceff5;
	z-index:30;
	}

#topBar{
	position:fixed;
	width:100%;
	height:45px;
	left:0px;
	top:0px;	
	background:#44619D;
	z-index:99;	
	}

#header{
	height:315px;
	width:850px;
	color:#fff;
	overflow:hidden;
	}
	
#headerBar{
	height:45px;
	width:850px;
	background:white;
	color:black;
	position:relative;
	top:-15px;
	margin-top:0px;
	
	}	
	
.clickableByVisitor
{
position:relative !important;
z-index:5001 !important;
}
	

.postPic{
		max-width:500px;
		float:none;	
		}
		
.attachCommentPic{
		max-width:500px;
		float:none;	
		}
		
.cameraIcon
		{
		position:relative;
		float:right !important;
		top:-7px;
		margin-right:20px;	
		}
		
.comment{
	color:grey;
	border 1px black;
	font-size:11px;
	background:#FAFBFB;
	padding-top:10px;
	min-height:40px;
	padding-bottom:5px;
	overflow:auto;
	
	}
	
#postStatusHeader,#postStatusFooter{
	width:500px;
	padding:7px;
	background:#F6F7F8;
	}
	
#postStatusFooter{
	text-align:right;
	min-height:20px;	
	overflow:auto;
	}
	
#postStatusBox{
	width:515px;
	background:#FFFFFF;
	}
	
textarea {
	width: 99%;
	font: 11px;
	outline: none;
	color:grey;
	resize: none;
	overflow: auto;
	font-family: 'lucida grande',tahoma,verdana,arial,sans-serif;
}




.postBar{
	border-top: 1px solid #EBEBEB;
	color:#4E5665;
	width:500px;
	padding:5px;
	text-align:left;
	font-size:11px;
	margin-left:0px;
	margin-bottom:-5px;
	overflow:auto;
	}

	
textarea {
		border:2px solid #ccc;
		vertical-align: top;
		}

.animated {
		-webkit-transition: height 0.2s;
		-moz-transition: height 0.2s;
		transition: height 0.2s;
		}	
	

	
	
.comName{
font-weight:bold;
color:#3B5998;
}
</style>
<script src="./message_files/jquery.min.js"></script><style type="text/css"></style>

<link rel="stylesheet" type="text/css" href="./message_files/style.css">
<script src="./message_files/jquery.autosize.js"></script>
<script>
premiumUserName="NONE"

function savethefave()
{
if(templateType=="fresh"){apprise("Please save the template first to get a unique URL.");return}
saveFave(self.location+"",	theTitle)//function called from _login.inc.php.
}

function loadTags() {
	allpeeps='["",';
	//alert(alreadyUsedPics["fred"])
	for(var key in alreadyUsedPics){
		if(key.indexOf(" here")==-1 && key.indexOf("<input")==-1 && key.length>3)
			{allpeeps+='"'+key+'",'}
		}
	allpeeps=allpeeps.substring(0, allpeeps.length - 1);
	allpeeps+=',"anonymous"]'
	//alert(allpeeps);
	//foreach($("body :input").autocomplete({source: eval(allpeeps)});
	$("#attachCommentName").autocomplete({source: eval(allpeeps)});
	$("#posterName").autocomplete({source: eval(allpeeps)});
	
	
	//$("body").find(":input").each(function(e)
		//{
		//var t=$(this).attr('id')
		//$("#"+t).autocomplete({source: eval(allpeeps)});
		//})
};

folder="1311";//folder id for this fb
subfolder="jUmjBH";//subfolder
//folder="2601";subfolder="xiZbBh";
textBoxOpen="";
templateType="unlocked";



function saveClicked()
{
if(textBoxOpen!=""){eval(textBoxOpen)}
if($("#profileNmText").text()=="Name here"){apprise("Please add the name of your character in the 'name here' space before saving.");return}
numberOfEntries=$('.comment').length+$('.stat').length
if(numberOfEntries<5){apprise("To save pressure on the server, at least 5 posts must be created before saving.");return}

	if(templateType=="fresh")
		{	$('.appriseOverlay').remove();$('.appriseOuter').remove()//IE bug means block isn't working.
			apprise('Please provide a password so you can edit this template later.', {'input':'PW'}, function(pw) {
				if(pw==""){saveClicked()}
				else{save(pw);}
			});
		}
		
	else//it can't be a 'locked' template because the click button would be disabled if so; so it's unlocked.
		{
		//Save and issue a success message
		save($("#pwBox").val())//save using the pw now saved into the form already.
		//No need to reload
		}
}

function deleteFB()
{
if(templateType!="unlocked")
	{alert("You must be logged in as the author before you can delete this profile");return}
	
	if(confirm("This will delete this Fakebook profile ENTIRELY. Are you sure you wish to proceed?")==true)
	{
	document.deletetest.editingMode.value=templateType;
	document.deletetest.folders.value="1311";
	document.deletetest.subfolders.value="jUmjBH"
	document.deletetest.submit()
	}
}


function askPW()
	{
	//Ask for the existing password
	$('.appriseOverlay').remove();$('.appriseOuter').remove()//IE bug means block isn't working.
	apprise('Please provide the password to edit this template.', {'input':'PW'}, function(pw) {
				if(pw){
					//Ajax call to check pw.
					$.ajax({ url: "../_FAKEBOOK/checkPW.php",
						data: {pw: pw, folder: folder, subfolder: subfolder},
						type: 'get',
						cache: false,
						async:false,
						success: function(data) {
							if(data.results=="success")
								{
								alert("Password accepted.");
								$("#blockDiv").remove();//editing now allowed.
								$("#pwBox").val(pw);
								templateType="unlocked";
								$("#saveBtnBanner").show();
								$("#addPostWrapper").show();
								}
							else{alert("Incorrect password.");}
							},
					error: function(x, t, m){
							apprise("Error Report - "+t);
							currentImg="fbimages/silhouette.jpg"	
							}
						});
					}
			});
	}

function save(pw){

//Profile Name and image
temp="<data>\n\n";
theTitle=$("#profileNmText").text();
temp+="<profileName><![CDATA["+theTitle+"]]></profileName>\n";
temp+="<profileImg><![CDATA["+$('#profileImg').attr('src')+"]]></profileImg>\n\n";

c=$('#wallpaperBtn').attr('src');
wallpaperchanged=0;
if(c.indexOf("fbpics/")==-1){wallpaperchanged=1}
if(c=="fbpics/cover.jpg"){c="fbpics/cover_blank.jpg";}

temp+="<coverImg>"+$('#wallpaperBtn').attr('src')+"</coverImg>\n\n";

//About
temp+="<about><![CDATA[";
temp+=$("#aboutBoxTextArea").val()
temp+="]]></about>\n\n";

//Blocks
blocksFull=1
numberOfBlocks=0
    $("#blocks").find(".leftBox").each(function() {
		numberOfBlocks++
		var title=$(this).find(".leftBoxTitle").html();
		blString="\n\t<block>\n\t\t<blockTitle><![CDATA["+title+"]]></blockTitle>";	
			$(this).find(".leftBoxElement").each(function() {
				leftBoxText = $(this).find(".leftBoxText").html();//text.
				leftImg = $(this).find('.leftImg').attr('src');	//image.
				blString+="\n\t\t\t<blockData><text><![CDATA["+leftBoxText+"]]></text><img>"+leftImg+"</img></blockData>"
				});
		temp+=blString+"\n\t</block>";
		if(blString.indexOf("type here")!=-1)
			{blocksFull=0}
		
    });
temp+="\n\n"

showcase="no";
numberOfEntries=$('.comment').length+$('.stat').length
numberOfVideos=$('.vidFrame').length
if(numberOfEntries>10 && numberOfVideos>=1 && wallpaperchanged==1 && blocksFull==1 && numberOfBlocks>=3){showcase="yes"}
//showcase="yes";

    $("#sortable").find(".stat").each(function() {
		//Gets all the posts.
		var name = $(this).find(".pName").html();
		var date = $(this).find(".pDate").html();
		var txt = removeLinks(removeBRs($(this).find(".pText").html()));
		var postImg = $(this).find('.postImg').attr('src')
		var postAttachImg = $(this).find('.postPic').attr('src')
		
		//
		var likesPost=$(this).find(".likePost").val();
		
		
			//Gets the comments for the post.
			comString="";
			$(this).find(".comment").each(function() {
				comText = removeLinks($(this).find(".comText").html());
				comName = $(this).find(".comName").html();
				comImg = $(this).find('.comImg').attr('src');
				comAttachImg =  $(this).find('.attachCommentPic').attr('src');
				var likesCom=$(this).find(".likeCom").val();	
				comString+="\n\t\t<comment><comName>"+comName+"</comName><comText><![CDATA["+comText+"]]></comText><comImg>"+comImg+"</comImg><comAttachImg>"+comAttachImg+"</comAttachImg><likesC><![CDATA["+likesCom+"]]></likesC></comment>";
				});
		temp+="\t<postBlock>\n\t\t<postEntry><name><![CDATA["+name+"]]></name><date><![CDATA["+date+"]]></date><txt><![CDATA["+txt+"]]></txt><postImg><![CDATA["+postImg+"]]></postImg><postAttachImg><![CDATA["+postAttachImg+"]]></postAttachImg><likesP><![CDATA["+likesPost+"]]></likesP></postEntry>";//post
		if(comString==""){temp+="\n\t\t";}
		else{temp+=comString}//comments
		temp+="\n\t</postBlock>\n\n";
    });

if(premiumUserName==""){premiumUserName="NONE"}
temp+="<premiumUser>"+premiumUserName+"</premiumUser>"
temp+="\n\n"
temp+="</data>"

	$.ajax({ url: "../../_FAKEBOOK/saveFile.php",
		data: {folder: folder, subfolder: subfolder, txt: temp, pw: pw, title: theTitle, addtoshowcase: showcase, templateType: templateType},
		type: 'post',
		cache: false,
		dataType: 'json',//RJT added
		async:false,
		success:function(data)
			{
			if(templateType!="fresh")
				{
				apprise("Template successfully resaved.<p>&nbsp;</p><div class='share-button'></div><p>&nbsp;</p>");
				
    			var share = new Share(".share-button", {
						image:"http://www.classtools.net/_squareicon.png",
						url:"http://www.classtools.net/FB/1311-jUmjBH", 
						  networks: {
							facebook: {
							  app_id: "602752456409826",
							},
						email: {
						  enabled: true,
						  title:  "Link to my Fakebook at ClassTools.net",
						  description: "Here's the link to my Fakebook = http://www.classtools.net/FB/1311-jUmjBH"
						}
						  }
						});
				
				
				}
			else
				{
				apprise('Template saved! Please make a careful note of the unique web address you will now be provided with!', {'confirm':true}, function() {
				$("#pwBox").val(pw);
				templateType="unlocked";
				folder=data.folder;
				subfolder=data.subfolder;
				alert(folder+" "+subfolder);
				$("#savedURL").val("http://www.classtools.net/FB/"+folder+"-"+subfolder);
				$("#reloadForm").submit();
				});	
					
				}
			},
		error: function (xhr, ajaxOptions, thrownError) 
			{
			err=(xhr.statusText);
			err+=(xhr.responseText);
			err+=(xhr.status);
			err+=(thrownError);
			//apprise("An error occurred. Please pass this data using the 'report a bug' feature so we can look into it:<p>"+err);
			apprise("SAVE FAILED. Please check your internet connection and try again.");
    		}
		});
}



  




function loadData(){
loadingUp=1;


if(templateType=="fresh"){loadingUp=0;return;}
$.get('../../_FAKEBOOK/saved/'+folder+'/'+subfolder+'/_data.xml?cachebuster='+Math.random(),function(x) {
	temp=""
    profileNm = $(x).find('profileName').text();
	$("#profileNmText").html(profileNm)
	theTitle=profileNm;
	isPremium=$(x).find('premiumUser').text();
	if(isPremium!="NONE"){removAds()}
	profileImage = $(x).find('profileImg').text();
	$('#profileImg').attr('src', profileImage);
	alreadyUsedPics[profileNm]=profileImage;
	var coverImage = $(x).find('coverImg').text();
	if(coverImage=="fbpics/cover.jpg"){coverImage="fbpics/cover_blank.jpg"}
	
	$('#wallpaperBtn').attr('src',coverImage);
	var abouttxt = $(x).find('about').text();
	$("#aboutBoxTextArea").val(abouttxt);
	
	addAbout()
	
	
	  	//BLOCKS
		$("#blocks").html("");//empty out.
		
		$(x).find('block').each(function(){
			$("#playGround").html(blockHTML);//create a new block in the playground area
			blockTit=$(this).find('blockTitle').text();
			$("#playGround .leftBoxTitle").html(blockTit)
			
			txt=new Array();pic=new Array();
					$(this).find('blockData').each(function(){
						txt.push($(this).find('text').text());
						pic.push($(this).find('img').text());
					});
			n=0;
			$("#playGround").find(".leftBoxElement").each(function() {
				$(this).find(".leftBoxText").html(txt[n]);//text.
				$(this).find('.leftImg').attr('src',pic[n]);	//image.
				alreadyUsedPics[txt[n]]=pic[n];
				n++
				});
			$("#blocks").append($("#playGround").html())
		});
		
		//POSTS AND COMMENTS
		
		$($(x).find('postBlock').get().reverse()).each(function(){
				//POSTS
				$(this).find('postEntry').each(function(){
						poster=$(this).find('name').text();
						d=$(this).find('date').text();
					
						txty=$(this).find('txt').text();
						
						currentImg=$(this).find('postImg').text();
						likesPost=$(this).find('likesP').text();
						postAttachImage=$(this).find('postAttachImg').text();
						$("#posterName").val(poster)
						$("#posterDate").val(d)
						$("#postBox").val(txty)
						$("#postPic").attr("src",postAttachImage);
						alreadyUsedPics[poster]=currentImg;
						addPost(1, 0);
						$("#likeInputPost"+postCounter).val(likesPost)
						if(likesPost!=""){addLikes(postCounter,1)}
						
					});
					//COMMENTS...
					$(this).find('comment').each(function(){
						comNm=$(this).find('comName').text();
						comTxt=$(this).find('comText').text();
						comImage=$(this).find('comImg').text();
						comAttachImage=$(this).find('comAttachImg').text();
						likesCom=$(this).find('likesC').text();
						//open comment box
						e=postCounter
						addCommentBx(1,e)

						//populate
						$("#attachCommentBox").val(comTxt)//comment
						$("#attachCommentPic").attr("src",comAttachImage);
						$("#attachCommentName").val(comNm)
						savedCommenterImg=comImage
						alreadyUsedPics[comNm]=comImage;
						//add
						addComment(1,e)
						$("#likeInputCom"+commentCounter).val(likesCom)
						if(likesCom!=""){addLikes(commentCounter,2)}
					});
		});
	loadingUp=0;
	},'xml');

setTimeout("loadTags()",5000);
}


	
/////POST FUNCTIONS/////
postCounter=0//gives unique identifier to each post
likesStarter="Liked by you, Fakebook and 25 others"
postOptions="<div id='postOptionsDiv' class='postBar'><a href='javascript:addLikesBx(XXX,1)'>Like</a> · <a href='javascript:addCommentBx(1,XXX)'>Comment</a> · <a href='javascript:editPost(XXX)'>Edit</a> · <a href='javascript:deletePost(XXX)'>Delete</a></div>"
postOptions+="<div class='likeBar' style='display:none' id='likesPostXXX'></div><span id='likeBxPostXXX' style='display:none'><input class='likePost' id='likeInputPostXXX' value=''><input type='button' value='Submit' onClick='javascript:addLikes(XXX,1)'></span>";
function addLikesBx(e,postOrCom)//1=post; 2=comment
{
prefix="Com"
if(postOrCom==1){prefix="Post"}
if(textBoxOpen!=""){eval(textBoxOpen)}
textBoxOpen="addLikes("+e+","+postOrCom+")"
$("#likeBx"+prefix+e).show();
if($("#likeInput"+prefix+e).val()==""){$("#likeInput"+prefix+e).val(likesStarter)}
$("#likes"+prefix+e).hide();
$("#likeInputXXX"+e).select();
}
function addLikes(e,postOrCom)
{
prefix="Com"
if(postOrCom==1){prefix="Post"}
$("#likes"+prefix+e).text($("#likeInput"+prefix+e).val());
$("#likeBx"+prefix+e).hide();
$("#likes"+prefix+e).show();
}



function addPost(freshNotEdit, e){		//for fresh posts, e=0; otherwise e is sent 
	$("#introBlurb").hide()
	if(freshNotEdit){
		if(textBoxOpen!=""){eval(textBoxOpen)}
		prefix=""
		poster=$("#posterName").val()
		if(poster==""){poster="Anonymous"}
		postCounter++;e=postCounter;comments="";
		temp="<div id='p"+e+"' class='stat'>";tempEnd="</div>"//wrapper for new post
		}
	else{
		prefix="edit"
		poster=$("#editposterName").val()
		if(poster==""){poster="Anonymous"}
		textBoxOpen="";
		temp="";tempEnd=""//no wrapper needed (edit in old post div)
		}
	if(loadingUp==0){getPic(poster);}//to get currentImg
	d=$("#"+prefix+"posterDate").val()
	
	n=$("#"+prefix+"postBox").val()
	//alert("1 - "+n)
	n=n.replace(/\n/g,"<br>")
	n=addLinks(n);
	t="<img class='postImg' id='postImg"+e+"' src='"+currentImg+"' /><span class='pName' id='postName"+e+"'>"+poster+"</span><br>"
	t+="<span class='pDate' id='postDate"+e+"'>"+d+"</span><br><span class='pText' id='postText"+e+"'>"+n+"</span><br>"
	atchdPic=$("#"+prefix+"postPic").attr("src");
	t+="<img class='postPic' id='postPic"+e+"' src='"+atchdPic+"' /><br>"
	//alert("2 - "+postOptions)
	t+=postOptions.replace(/XXX/g,e);
	t+="<div class='c' id='c"+e+"'>"+comments+"</div>"
	temp+=(t+tempEnd)
		if(freshNotEdit){$("#sortable").prepend(temp)}
		else{$("#p"+e).html(temp);}
	if(atchdPic.indexOf("pics/camera.png")!=-1){$("#postPic"+e).hide()}
	if(freshNotEdit){freshPostBox()}
}



function deletePost(e){
	$('.appriseOverlay').remove();$('.appriseOuter').remove()//IE bug means block isn't working.
	apprise('Are you sure?', {'verify':true}, function(r) {
		if(r) {$("#p"+e).remove()}
	});
}
	
function editPost(e){
	if(textBoxOpen!=""){eval(textBoxOpen)}
	textBoxOpen="addPost(0,"+e+")";
	comments=$("#c"+e).html()
	ppic=$("#postPic"+e).attr("src");
	poster=$("#postName"+e).html()
	d=$("#postDate"+e).html()
	
	temp=$("#postText"+e).html()	
	temp=removeBRs(temp)
	temp=removeLinks(temp)
	t="<div class='postBar'><input type='text' name='editposterName' id='editposterName' value='"+poster+"'><br>";
	t+="<input type='text' name='editposterDate' id='editposterDate' value='"+d+"'><br>"
	t+="<textarea name='editpostBox' rows='2' id='editpostBox'>"+temp+"</textarea>\<br>"
	t+="<img class='editpostPic' id='editpostPic' src='"+ppic+"' /><br>"
	t+="<input type='button' style='display:none' id='rmvBtn' class='blueBtn' value='Remove Image' onClick='rmvit(\"editpostPic\")'>"
	t+="<input type='button' class='blueBtn' value='Submit' onClick='addPost(0,"+e+")'></div>"
	$("#p"+e).html(t);
	if(ppic.indexOf("pics/camera.png")==-1){$("#rmvBtn").show()}
	init()
	$("#editposterName").focus()
}


/////END OF POST FUNCTIONS/////



///////////COMMENT FUNCTIONS////////////
commentCounter=0
commentOptions="<div class='comBar'><a href='javascript:addLikesBx(XXX,2)'>Like</a> · <a href='javascript:addCommentBx(0,XXX)'>Edit</a> · <a href='javascript:deleteComment(XXX)'>Delete</a></div>"
commentOptions+="<div class='likeBarCom' style='display:none' id='likesComXXX'></div><span id='likeBxComXXX' style='display:none'><input class='likeCom' id='likeInputComXXX' value=''><input type='button' value='Submit' onClick='javascript:addLikes(XXX,2)'></span>";


function addComment(freshNotEdit,e){//e = post number.
	prefix="edit"
	if(freshNotEdit)
		{
		//if($("#attachCommentName").val()==""){if(loadingUp==0){apprise("Please provide a name ");return}} - disabled
		commentCounter++;
		prefix="attach"
		}
	textBoxOpen=""
	temp=$("#"+prefix+"CommentBox").val()	
	//alert("3 - "+temp)
	txt=temp.replace(/\n/g,"");//clear up the text
	txt=removeBRs(txt)///clear up the text
	txt=addLinks(txt)
	atchdPic=$("#"+prefix+"CommentPic").attr("src");
	name=$("#"+prefix+"CommentName").val()
	if(loadingUp==0){getPic(name);}
	else{currentImg=savedCommenterImg}
	if(freshNotEdit){$('#p'+e+' #commentWrapper').remove();}
	t="";tend="";if(freshNotEdit){t="<div id='com"+commentCounter+"' class='comment'>";tend="</div>"}
	z=e;if(freshNotEdit){z=commentCounter}
	t+="<img id='comImg"+z+"' class='comImg' src='"+currentImg+"' />"
	t+="<span class='comName' id='comName"+z+"'>"+name+"</span>"
	t+="&nbsp;<span class='comText' id='comText"+z+"'>"+txt+"</span>"
	t+=commentOptions.replace(/XXX/g,z);
	t+="<br><img class='attachCommentPic' id='attachCommentPic"+z+"' src='"+atchdPic+"' />"+tend
		if(freshNotEdit){$("#c"+e).append(t);}//e=postnumber
		else{$("#com"+e).html(t);}//e=commentnumber
	if(atchdPic.indexOf("pics/camera.png")!=-1){$("#attachCommentPic"+z).hide()}
	if(freshNotEdit){$('#p'+e+' #postOptionsDiv').show();$( "#c"+e).sortable({axis: 'y',containment:"#c"+e});}
}

function addCommentBx(freshNotEdit,e){//e = post
	if(textBoxOpen!=""){eval(textBoxOpen)}
	prefix="edit"
	if(freshNotEdit){
		prefix="attach"
		poster="";
		temp="Write a comment...."; 
		atchdPic='fbpics/camera.png'
		$('#p'+e+' #postOptionsDiv').hide();
	}
	else{
		atchdPic=$("#attachCommentPic"+e).attr("src");
		savedCommenterImg=$("#comImg"+e).attr("src");
		poster=$("#comName"+e).html()
		temp=$("#comText"+e).html()
		temp=removeBRs(temp)
		//alert("4 - "+temp)
		temp=temp.replace(/\n/g,"");
		temp=removeLinks(temp)
	}
	
	textBoxOpen="addComment("+freshNotEdit+","+e+")";
	t="<div id='commentWrapper'>"
	t+="<input type='text' name='"+prefix+"CommentName' id='"+prefix+"CommentName' value='"+poster+"'><br>"
	t+="<textarea name='"+prefix+"CommentBox' rows='2' id='"+prefix+"CommentBox'>"+temp+"</textarea><br>"
	t+="<img class='"+prefix+"CommentPic' id='"+prefix+"CommentPic' src='"+atchdPic+"' /><br>"
	t+="<input type='button' style='display:none' id='rmvBtn' class='blueBtn' value='Remove Image' onClick='rmvit(\""+prefix+"CommentPic\")'>"
	t+="<input type='button' class='blueBtn' value='Submit' onClick='addComment("+freshNotEdit+","+e+")'>"
	t+="</div>"
	
	if(freshNotEdit){
		$("#c"+e).append(t);
		$("#"+prefix+"CommentBox").select();
		init();
		if(loadingUp==0){$('html, body').animate({ scrollTop: $("#commentWrapper").offset().top-150 }, 500);}//scroll to it in case this is a long thread
		}
	else{
		$("#com"+e).html(t);
		if(atchdPic.indexOf("pics/camera.png")==-1){$("#rmvBtn").show()}
		init()
		$("#editCommentName").focus()
		}
	loadTags()
}

function deleteComment(e){
	$('.appriseOverlay').remove();$('.appriseOuter').remove()//IE bug means block isn't working.
	apprise('Are you sure?', {'verify':true}, function(r) {if(r) {$("#com"+e).remove()}});
}
	

///////////END OF COMMENT FUNCTIONS////////////


/////////////////////////////////
//Profile Name / Image functions.
profileNm="Name here";
function addNameBox(){
	if(textBoxOpen!=""){eval(textBoxOpen)}
	textBoxOpen="changeName()";
	$("#editProfileName").show();
	$("#editProfileName").val(profileNm);
	$("#editProfileName").focus();
	if($('#editProfileName').val()=="Name here"){$('#editProfileName').select()}
	$("#profileNmText").hide();
	$('#editProfileName').pressEnter(function(){changeName()});
}
function changeName(){
	textBoxOpen=""
	profileNm=$("#editProfileName").val();
	getPic(profileNm);//to get currentImg
	$('#profileImg').attr('src', currentImg);
	$("#editProfileName").hide();
	$("#profileNmText").show();
	$("#profileNmText").html(profileNm)
	}
///////////END OF PROFILE NAME/IMAGE FUNCTIONS////////////


function removAds()
{
$("#advert1").hide()
$("#advert2").hide()
$("#advert3").hide()
$("#advert4").hide()
$("#premAd").hide()
}





</script>

<style type="text/css"></style></head>


<body>
<div id="modal" class="modal" style="display: none;">
<h1 align="center" style="font-family:Verdana, Geneva, sans-serif">Fakebook Loading: Please Wait...</h1>

</div>
<style>
/* Start by setting display:none to make this hidden.
   Then we position it in relation to the viewport window
   with position:fixed. Width, height, top and left speak
   speak for themselves. Background we set to 80% white with
   our animation centered, and no-repeating */
.modal {
	zoom:1;
    display:    block;
    position:   fixed;
    z-index:    9999999;
    top:        0px;
    left:       0px;
    height:     100%;
    width:      100%;
	/*filter: alpha(opacity=50);*/
	/*opacity: 0.5;*/
    background: grey
                url('../../_FAKEBOOK/uploadImage/images/spinner.gif') 
                50% 50% 
                no-repeat;
}
</style>
<script>
$(document).ajaxStart(function() {$("#modal").show();});
$(document).ajaxStop(function() {$("#modal").hide();});
</script>
<div id="publicOptions" style="position:fixed; right:0px;top:-15px; z-index:10000">
    	<p>
         <!--<span class="redBtn clickableByVisitor"><a href="javascript:contactForm()">REPORT A BUG!</a></span>-->
        
        
         
         
        
        
        
          
          
         
         
        &nbsp;</p>
        </div>

 
<div id="container" style="padding-right: 0px;">
  <div id="header" data-intro="You can click here to add a wallpaper image" data-position="right">
	
            <img data-intro="Welcome to Fakebook!" data-position="top" id="profileImg" src="./message_files/silhouette.jpg">
            <span id="profileName" data-intro="Start by adding a name here" data-position="top">
            <a href="javascript:addNameBox()"><span id="profileNmText" style="color:white">Intuit</span></a>
            <input style="font-size:x-large;display:none" type="text" name="editProfileName" id="editProfileName">
          
            </span>
            
            <span style="position:relative;top:-170px;width:850px;float:right;overflow:hidden;background:#3C5A9A">
            <img style="float:right;z-index:-1;margin:0;height:313px" id="wallpaperBtn" src="./message_files/cover_blank.jpg">
    		</span>
         
    </div>
    
   
    <div id="headerBar">
    
    	<p>
          
        </p>
    </div>
    
    	
    </div>
    

<div id="leftWrapper">

<div id="aboutBox" data-intro="Add some profile information here" data-position="top">
<form action="/signup" method="post">
    	<div class="leftBox">
        <div class="aboutTitle">About</div>
        <span id="aboutBoxText" style="clear:both;padding-top:10px;font-size:small;;">Relationship: <input type = "text" name="Relationship"> 
<hr>Family: <input type = "text" name="Family"><hr>
<hr>Work: <input type = "text" name = "Work"><hr>
<input type="submit" value="Submit"/>
</form>
</span>
        </div>
    </div>
	
     <br>

	
    <div id="advert2">
        <div class="leftBox">
            <div class="aboutTitle">Sponsored Links</div>
            <div style="text-align:center;margin:auto">
                 <script type="text/javascript"><!--
                google_ad_client = "ca-pub-8912794096382956";
                /* Fakebook NEW - leftBox */
                google_ad_slot = "4651706527";
                google_ad_width = 300;
                google_ad_height = 250;
                //-->
                </script>
                <script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
                </script>
             </div>
         </div>
     </div>

    <div id="blocks" class="ui-sortable">
               <div class="leftBox" data-intro="You can add blocks (e.g. &#39;friends&#39;, &#39;enemies&#39;, &#39;family&#39;) here" data-position="bottom">
               <img src="./message_files/delete.gif" class="deleteCross" id="cross">
                        <div class="leftBoxTitle">Friends (click here to change title)</div>
                        <br>
                        <span class="leftBoxElement"><img class="leftImg" src="./message_files/invis.gif"><span class="leftBoxText">type here</span></span>
                        <span class="leftBoxElement"><img class="leftImg" src="./message_files/invis.gif"><span class="leftBoxText">type here</span></span>
                        <span class="leftBoxElement"><img class="leftImg" src="./message_files/invis.gif"><span class="leftBoxText">type here</span></span>
                        <span class="leftBoxElement"><img class="leftImg" src="./message_files/invis.gif"><span class="leftBoxText">type here</span></span>
                        <span class="leftBoxElement"><img class="leftImg" src="./message_files/invis.gif"><span class="leftBoxText">type here</span></span>
                        <span class="leftBoxElement"><img class="leftImg" src="./message_files/invis.gif"><span class="leftBoxText">type here</span></span>
      			</div>
    </div>           
            
     <div id="addNewBlock">
     <a href="javascript:attachNewBlock()">Add New Block</a>
     </div>
     <p>&nbsp;</p>
     
     
     
</div>

<script>
blockHTML=$("#blocks").html();
function attachNewBlock()
{
$("#blocks").prepend(blockHTML);
init();
}


</script>
    
       
                      <div id="mainArea" data-intro="You can start adding posts here" data-position="top">
                      
               
                      	<span id="addPostWrapper">
                            <div id="postStatusHeader">
                            <p><b>Add a post!</b>
                            <br><span style="font-size:11px;color:grey"> 
                            (TIP 1: You can add hyperlinks and links to YouTube/Vimeo videos too!)
                            <br>(TIP 2: You can click on any image that appears to change it!)
                            </span>
                            </p>
                              <p>
                                Name
                                <span role="status" aria-live="polite" class="ui-helper-hidden-accessible"></span><input name="posterName" type="text" id="posterName" value="Name...." class="ui-autocomplete-input" autocomplete="off">
                              Date
                                <input name="posterDate" type="text" id="posterDate" value="earlier today....">
                              </p>
                            </div>
                                <div id="postStatusBox">
                                <textarea class="animated" name="postBox" id="postBox" style="overflow: hidden; word-wrap: break-word; resize: none; height: 32px;">Write something....</textarea>
                                </div>
                                
                            <div id="postStatusFooter">
                                <input type="button" class="blueBtn" name="but" id="but" value="Post" onclick="addPost(1,0)">
                                <img id="postPic" class="postPic cameraIcon" src="./message_files/camera.png">
                                <input style="display:none" type="button" class="blueBtn" name="rmv" id="rmv" value="Remove" onclick="$(&#39;#postPic&#39;).attr(&#39;src&#39;, &#39;fbpics/camera.png&#39;);$(this).hide()">
                            </div>
                         </span>
                            
                            <div id="sortable" class="ui-sortable"><div id="p5" class="stat"><img class="postImg" id="postImg5" src="./message_files/silhouette.jpg"><span class="pName" id="postName5">Grandpa died :'(</span><br><span class="pDate" id="postDate5">earlier today....</span><br><span class="pText" id="postText5">Write something.... </span><br><img class="postPic" id="postPic5" src="./message_files/camera.png" style="display: none;"><br><div id="postOptionsDiv" class="postBar"><a href="javascript:addLikesBx(5,1)">Like</a> · <a href="javascript:addCommentBx(1,5)">Comment</a> · <a href="javascript:editPost(5)">Edit</a> · <a href="javascript:deletePost(5)">Delete</a></div><div class="likeBar" style="display:none" id="likesPost5"></div><span id="likeBxPost5" style="display:none"><input class="likePost" id="likeInputPost5" value=""><input type="button" value="Submit" onclick="javascript:addLikes(5,1)"></span><div class="c" id="c5"></div></div><div id="p4" class="stat"><img class="postImg" id="postImg4" src="./message_files/silhouette.jpg"><span class="pName" id="postName4">2 months away from a full family!</span><br><span class="pDate" id="postDate4">earlier today....</span><br><span class="pText" id="postText4">Write something.... </span><br><img class="postPic" id="postPic4" src="./message_files/camera.png" style="display: none;"><br><div id="postOptionsDiv" class="postBar"><a href="javascript:addLikesBx(4,1)">Like</a> · <a href="javascript:addCommentBx(1,4)">Comment</a> · <a href="javascript:editPost(4)">Edit</a> · <a href="javascript:deletePost(4)">Delete</a></div><div class="likeBar" style="display:none" id="likesPost4"></div><span id="likeBxPost4" style="display:none"><input class="likePost" id="likeInputPost4" value=""><input type="button" value="Submit" onclick="javascript:addLikes(4,1)"></span><div class="c" id="c4"></div></div><div id="p3" class="stat"><img class="postImg" id="postImg3" src="./message_files/pregnant.jpg"><span class="pName" id="postName3">Pregnant</span><br><span class="pDate" id="postDate3">2 months ago</span><br><span class="pText" id="postText3">Write something.... </span><br><img class="postPic" id="postPic3" src="./message_files/camera.png" style="display: none;"><br><div id="postOptionsDiv" class="postBar"><a href="javascript:addLikesBx(3,1)">Like</a> · <a href="javascript:addCommentBx(1,3)">Comment</a> · <a href="javascript:editPost(3)">Edit</a> · <a href="javascript:deletePost(3)">Delete</a></div><div class="likeBar" style="display:none" id="likesPost3"></div><span id="likeBxPost3" style="display:none"><input class="likePost" id="likeInputPost3" value=""><input type="button" value="Submit" onclick="javascript:addLikes(3,1)"></span><div class="c" id="c3"></div></div><div id="p2" class="stat"><img class="postImg" id="postImg2" src="./message_files/engaged.jpg"><span class="pName" id="postName2">Engaged</span><br><span class="pDate" id="postDate2"></span><br><span class="pText" id="postText2">Getting engaged &lt;3 </span><br><img class="postPic" id="postPic2" src="./message_files/camera.png" style="display: none;"><br><div id="postOptionsDiv" class="postBar"><a href="javascript:addLikesBx(2,1)">Like</a> · <a href="javascript:addCommentBx(1,2)">Comment</a> · <a href="javascript:editPost(2)">Edit</a> · <a href="javascript:deletePost(2)">Delete</a></div><div class="likeBar" style="display:none" id="likesPost2"></div><span id="likeBxPost2" style="display:none"><input class="likePost" id="likeInputPost2" value=""><input type="button" value="Submit" onclick="javascript:addLikes(2,1)"></span><div class="c" id="c2"></div></div><div id="p1" class="stat"><img class="postImg" id="postImg1" src="./message_files/silhouette.jpg"><span class="pName" id="postName1">Looking for new house</span><br><span class="pDate" id="postDate1"></span><br><span class="pText" id="postText1">Looking for new house </span><br><img class="postPic" id="postPic1" src="./message_files/camera.png" style="display: none;"><br><div id="postOptionsDiv" class="postBar"><a href="javascript:addLikesBx(1,1)">Like</a> · <a href="javascript:addCommentBx(1,1)">Comment</a> · <a href="javascript:editPost(1)">Edit</a> · <a href="javascript:deletePost(1)">Delete</a></div><div class="likeBar" style="display:none" id="likesPost1"></div><span id="likeBxPost1" style="display:none"><input class="likePost" id="likeInputPost1" value=""><input type="button" value="Submit" onclick="javascript:addLikes(1,1)"></span><div class="c" id="c1"></div></div>
                            <p>&nbsp;</p>
                            
                            <span align="center" id="advert4" style="margin-left:20px">
                            <script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                            <!-- Fakebook Horizontal -->
                            <ins class="adsbygoogle" style="display:inline-block;width:468px;height:60px;" data-ad-client="ca-pub-8912794096382956" data-ad-slot="8193936867"></ins>
                            <script>
                            (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                            </span>
                            
                             <p>&nbsp;</p>
                            
                            </div> 
                            
                            
                            <!-- INTRO -->                    
<div id="introBlurb" style="display:none">
<h3 align="center">"Fakebook" allows teachers and students to create imaginary profile pages  for study purposes.</h3>

                <div align="center">
                
                
                </div>
                
                <p align="center">Use "Fakebook" to chart the plot of a book, the development of a character, a series of historical events, the debates and relationships between people, and so on!</p>
                
                <p align="center">Get started by entering a name at the top of the page. Then proceed to add friends, posts, comments and profile information.</p>
                <p align="center">You can save your work and edit it again later.</p>
</div>
   <!-- INTRO -->  
                            
                        </div>
                        
                         
                        
                        
                        <div id="rightBar">
                        
                        
                        
                        
                        
                        	<span id="advert1">
								<script type="text/javascript"><!--
                                google_ad_client = "ca-pub-8912794096382956";
                                /* FakebookNew - SideTower */
                               
                                //-->
                                </script>
                              
                            </span>
                            
                            <p>&nbsp;</p>
                            
                            
                            
                            <p>&nbsp;</p>
                            
                            <span id="advert3">
								
                                <!-- Fakebook NEW - leftBox -->
                               
                                </script>
                            </span>
                            
                        </div>
                        
                    




<div id="fixedRight" style="display: none;">
fixedRight
</div>


<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p>


<script>
alreadyUsedPics=new Array();
function firstLoad()
{
str="";



$("#videoIntro").attr('src',"http://player.vimeo.com/video/25366185?autoplay=0" )

if(templateType!="locked")
	{
	$('#saveBtnBanner').show()	
	}

if(templateType=="fresh")
	{
	$("#introBlurb").show()
	$('body').chardinJs('start');
	$('body').click(function(){$('body').chardinJs('stop')})
	}
//if(templateType=="fresh"){apprise("<h1 align='center'>Welcome to the new Fakebook!</h1><br>Get started by inputting a name, adding some information in the 'about' box, and adding some posts!");}
	
	if(templateType=="locked")//lock down the screen until we know it's loaded up / unlocked.
	{
	$("#addPostWrapper").hide();
		$("#blockDiv").click(function(e) {
			askPW();
			return false;
		});
	}

loadData();//load it up!


addAbout()

if(templateType!="locked")//and now remove blocks on editing if it's not a locked template.
		{$("#blockDiv").remove()}

	$("#blocks").sortable({axis: 'y',containment:"#blocks"});
	$(document).on('click', '#aboutBox', function() 
		{
		if(textBoxOpen!=""){eval(textBoxOpen)}
		textBoxOpen="addAbout()";
		$("#aboutBoxTextArea").show()
		$("#aboutBoxText").hide()
		});
		$('#aboutBoxTextArea').blur(function(){
			addAbout()
			});

$(document).on('click', '#aboutBoxTextArea', function(e) {e.stopPropagation();});//stop clicks in textbox firing the aboutarea re-opening it again
	
	//SIDEBOX FUNCTIONS
			$(document).on('click', '.leftBoxText, .leftBoxTitle', function() {
			
			if($('#editSideBoxText').length)//if another sidebox is already open (not this one) then process it.
				{
				if(!$("#editSideBoxText").is(":hover")){$('#editSideBoxText').blur()}
				}

				tit=$(this).attr('class');
				if(textBoxOpen!=""){eval(textBoxOpen)}
				temp=$(this).text()
				childEl=$(this)
				var parentEl = $(this).closest('.leftBoxElement');
				i="<input style='font-size:x-small;width:94px;padding:0px;' type='text' name='editSideBoxText' id='editSideBoxText' value=''>"
				$(this).html(i);
				$("#editSideBoxText").val(temp);
				$("#editSideBoxText").focus();
				if(temp=="type here"){$("#editSideBoxText").select();}
				$('#editSideBoxText').pressEnter(function()
					{
					$(this).blur()
					});
				$('#editSideBoxText').blur(function(){
					if($("#editSideBoxText").val()==""){$("#editSideBoxText").val("type here")}
					if(tit!="leftBoxTitle"){addBoxPic(childEl,parentEl)}
					else{n=$("#editSideBoxText").val();$(childEl).html(n)}
					});
				return;
				});
				$(document).on("click", ".deleteCross", function() {
					if(confirm("Are you sure you want to delete this block?")){$(this).parent().fadeOut(500, function(){ $(this).remove();})}
					
				});
	
	$('.normal').autosize();
		$('.animated').autosize({append: "\n"});
	$('#profileNmText').on('click', function() {addNameBox()});
	//$('#editProfileName').on('blur', function() {changeName()});
	
	
	
	$('body').on('click', 'a', function() {$('textarea').blur()});
	
	//IMAGE CLICKED.
	$('body').on('click', 'img', function() {
		if(templateType=="fresh")
			{apprise("After creating a few posts and saving your template, you will be able to upload pictures directly from your computer by clicking on them.");return}////RJT DISABLED FOR THE MOMENT
		
		if(!this.id.length)
			{
			$(this).attr('id','tempID'+Math.floor(Math.random()*5000));//give this pic a unique id dynamically.
			}
			var id = $(this).attr('id');
			flag=0
			a="tempID*wallpaperBtn*comImg*postImg*profileImg*postPic*editpostPic*attachCommentPic*editCommentPic";
			a=a.split("*");
			for(n=0;n<a.length;n++)
				{
				if(id.indexOf(a[n])!=-1)
					{
					flag=1;nm="";//Get the associated name for this image.
					if(a[n]=="postImg"){nm=$("#"+id).siblings("span.pName:first").html();}
					if(a[n]=="comImg"){nm=$("#"+id).siblings("span.comName:first").html();}
					if(a[n]=="profileImg"){nm=$("#profileNmText").text();}
					if(a[n]=="tempID"){nm=$("#"+id).siblings("span.leftBoxText:first").html();}//leftBoxText
					}
				}
			if(flag==1)
				{
				h=160;w=160;
				if(id.indexOf("CommentPic")!=-1 || id.indexOf("postPic")!=-1)
					{h=300;w=550;}
				if(id=="wallpaperBtn")
					{h=315;w=850;}
				$('.appriseOverlay').remove();$('.appriseOuter').remove()//IE bug means block isn't working.
				apprise
					("",
					{'confirm' : true},
					function (e)
						{
						if(e){
							if(imgURL=="NONE"){apprise("No image selected");return}
							addToPicsDatabase(nm,imgURL)
							imgURL="fbsaved/"+imgURL;
							if(nm!="")
								{
								if((nm in alreadyUsedPics))//If this picture is being changed, change in all posts now.
									{
									imgToReplace=alreadyUsedPics[nm]
									temp=$("#container").html();
									temp=temp.split(alreadyUsedPics[nm]);
									temp=temp.join(imgURL)
									$("#container").html(temp)
									init()
									}
								alreadyUsedPics[nm]=imgURL;
								loadTags()
								}//save the image in an array so it will be spotted next time this name is used.
							$('#'+id).attr('src', imgURL);
							if(id=="postPic"){$('#rmv').show()}//show the 'remove' button for the post image.
							if(id.indexOf("editpostPic")!=-1){$('#rmvBtn').show()}//show the 'remove' button for the edited post image.
							if(id.indexOf("CommentPic")!=-1){$('#rmvBtn').show()}//show the 'remove' button for the edited post image.
							}
						}
					)
				}
			});
}

function addToPicsDatabase(uploadedNm,uploadImg)//Uploads a user-uploaded pic to the database (i.e. crowdsource). Disable if it starts clogging server.
{
return;//RJT DISABLED
uploadedNm=uploadedNm.replace(/^\s+|\s+$/gm,'');
if(uploadedNm.indexOf(" ")==-1){return}
if(uploadedNm.indexOf("'")!=-1){return}
if(uploadedNm.indexOf("<")!=-1){return}

	
temp=uploadedNm.split(" ");
if(temp.length!=2){return}//only go for names which are two words.

uploadNm=uploadedNm.toLowerCase();
uploadNm=uploadNm.replace(/[^a-zA-Z 0-9]+/g,'');
uploadNm=uploadNm.split(" ");uploadNm=uploadNm.join("_");
$.ajax({ url: "../../_FAKEBOOK/_getPic/uploaded.php",
			 data: {parsedName: uploadNm, uploadImg: uploadImg, rlNm: uploadedNm},
			 type: 'get',
			 cache: false,
			 async: false
		});	
}





function addAbout(){
		textBoxOpen=""
		n=$("#aboutBoxTextArea").val();
		//alert("5 - "+n)
		n=n.replace(/\n/g,"<hr><img height='10px' src='fbpics/circle.gif' />")
		//alert("5 ok")
		$("#aboutBoxTextArea").hide()
		$("#aboutBoxText").show()
		$("#aboutBoxText").html("<img height='10px' src='fbpics/circle.gif' />"+n)
		}
		

function addBoxPic(childEl,parentEl){
				n=$("#editSideBoxText").val();
				if(n!="type here"){getPic(n);$("img",parentEl).attr("src",currentImg);}
				$(childEl).html(n)
				}

		
function unloading()
{
//clear out the temp images if page being left without a save.
//NO LONGER NEEDED: Because the folders are only created now AFTER a save anyway, and users cannot upload images until after a save.
return;
/*
if(templateType=="fresh")
	{
		$.ajax({ url: "../../_FAKEBOOK/delete-temp-images.php",
			 data: {folder: folder, subfolder: subfolder},
			 type: 'get',
			 cache: false,
			 async: false
		});
	}
*/
}

//Remove breaks from comments when enter is pressed for submit.
function removeBRs(temp){
	//alert("6 - "+temp)
	temp=temp.replace(/\<br\>/g, "\n");
    temp=temp.replace(/\<br \/\>/g, "\n");
	temp=temp.replace(/\<BR\>/g, "\n");
    temp=temp.replace(/\<BR \/\>/g, "\n");
	//alert("6 ok")
	return temp
}


//Display the sidebar if the screen is wide enough.
$(window).resize(function() {
	if($(window).width()<1375)
		{
		$("#fixedRight").hide(); 
		$("#container").css("padding-right","0px"); 
		if (typeof window.console !== 'undefined') {console.log($(window).width())}
		}
	if($(window).width()>=1375)
		{
		$("#fixedRight").show(); 	
		$("#container").css("padding-right","205px"); 
		}
}).resize();

//Detect enter being pressed.
$.fn.pressEnter = function(fn) {  
    return this.each(function() {  
        $(this).bind('enterPress', fn);
        $(this).keyup(function(e){
            if(e.keyCode == 13)
            {
              $(this).trigger("enterPress");
            }
        })
    });  
 }; 

//Remove attached image and replace with camera.
function rmvit(n){
	$("#"+n).attr('src', "fbpics/camera.png");
	$("#rmvBtn").hide()
}

/////////////////////////
//Picture Functions
function getPic(aname)
{
aname=$.trim(aname);
//Block screen (for IE as ajaxstart doesn't work in IE).
searchName=aname;
if((searchName in alreadyUsedPics))
	{currentImg=alreadyUsedPics[searchName];return}
aname=aname.toLowerCase();
//alert("7 - "+aname);
aname=aname.replace(/[^a-zA-Z 0-9]+/g,'');
aname=aname.split(" ");aname=aname.join("_");
$.ajax({ url: "../../_FAKEBOOK/_getPic/index.php",
			 data: {searchName: searchName, parsedName: aname},
			 type: 'get',cache: false, dataType: 'json', async:false,
			 success: function(data) 
					{
					if(data.results=="BAD_IMAGE"){currentImg="fbimages/silhouette.jpg"	}
					else{currentImg="fbimages/"+aname.charAt(0)+"/"+data.results;}
					alreadyUsedPics[searchName]=currentImg;
					loadTags()
					},
			error: function(x, t, m) 
					{
					$("#modal").hide();//Block screen.
            		apprise("Error Report - "+t);
					currentImg="fbimages/silhouette.jpg"	
					}
		});
}


function freshPostBox(){
	$("#postBox").val("Write something....");
	$("#posterDate").val("earlier today....");
	$("#posterName").val("Name....");
	$("#posterName").select()
	$('#postPic').attr('src', "fbpics/camera.png");
	$('#rmv').hide()
}

function init() {
	$("#modal").hide();
	$("#sortable").sortable({containment:"#sortable"});//Apply sortable function to the main posts.
 	$('textarea').autosize(); 
	$('input, textarea').on('focus', function(e) {if($(this).val().indexOf("....")!=-1){$(this).val('')}});
	if(templateType=="unlocked"){$("#delBtn").show()}
	}
	
	
function addLinks(str){
	if (str.indexOf(" www.")!=-1){str=str.split(" www.");str=str.join(" http://www.")}
	
	//VIDEO
	ytflag=0;vimFlag=0
	if(str.indexOf("http://www.youtube.com/")!=-1){
			ytflag=1
			ytStem=str.split("http://www.youtube.com/")
			}
	if(str.indexOf("https://www.youtube.com/")!=-1){
			ytflag=1
			ytStem=str.split("https://www.youtube.com/")
			}
	if(str.indexOf("http://youtu.be/")!=-1){
			ytflag=1
			ytStem=str.split("http://youtu.be/")
			}
	if(ytflag==1){
			ytStem2=ytStem[1].split(" ")
			//alert(ytStem2[0])
			if(ytStem2[0].indexOf("?")==-1){vidId=ytStem2[0]}
			else{vidId=getYouTubeParameter("http://www.youtube.com/"+ytStem2[0], 'v')}
			//alert(vidId)
			ytStem2.splice(0,1);ytStem2=ytStem2.join(" ");
			str=ytStem[0]+ytStem2
			str+='<iframe id="hztp://www.youtube.com/watch?v='+vidId+'" class="vidFrame" width="500" height="320" src="hztp://youtube.com/embed/'+vidId
			str+='" frameborder="0" allowfullscreen></iframe>'
			}
	else if(str.indexOf("http://vimeo.com/")!=-1)
		{
		vimFlag=1
		ytStem=str.split("http://vimeo.com/")
		ytStem2=ytStem[1].split(" ")
		vidId=ytStem2[0]
		ytStem2.splice(0,1);ytStem2=ytStem2.join(" ");
		str=ytStem[0]+ytStem2
		
		//temp3=str.split("vimeo.com/")
		//temp3=temp3[1]
		//if(temp3.indexOf(" ")!=-1){temp3=temp3.split(" ");temp3=temp3[0]}
		//vidId=temp3
		if(isNumber(vidId))
			{
			str+='<iframe id="hztp://vimeo.com/'+vidId+'" class="vidFrame" src="hztp://player.vimeo.com/video/'+vidId+'?title=0&amp;byline=0&amp;portrait=0" width="'
			str+='500px" height="380px" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'
			}
		}
	var regex = /(https?:\/\/([-\w\.]+)+(:\d+)?(\/([\w\/_\.]*(\?\S+)?)?)?)/ig
	//alert("8 - "+str)
	str= str.replace(regex, "<a href='$1' target='_blank'>$1</a>");	
	if(str.indexOf("hztp://")!=-1){str=str.split("hztp://");str=str.join("http://");}
	return str
	}
function removeLinks(str){
	//str.replace(/<\/?[A-Z]+.*?>/g, function (m) { return m.toLowerCase(); }) - should convert IE tags with any luck
	//might be worth looking at the old FB for other pain in the arse browswers too.
	var tree = $("<div>" + str + "</div>");
	$(tree).find('a[href]').replaceWith(function() { return this.childNodes });
	str=tree.html();	
	//THIS STRIPS OUT THE VIDEO and replaces it with its raw id.
	var stringOfHtml = str;
	te='iframe id="';z=""
	if(str.indexOf(te)!=-1){z=str.split(te);z=z[1];z=z.split('" ');z=z[0];}
	else
		{
		te='IFRAME id=';//IE format...pain in the arse.
		if(str.indexOf(te)!=-1){z=str.split(te);z=z[1];z=z.split(' ');z=z[0]}
		}
	var wrappedString = '<div>' + stringOfHtml + '</div>';
	//alert("9 - "+wrappedString)
	var noScript = wrappedString.replace(/iframe/g, "THISISNOTASCRIPTREALLY");
	var noScript = noScript.replace(/IFRAME/g, "THISISNOTASCRIPTREALLY");//IE AGAIN
	var html = $(noScript);
	html.find('THISISNOTASCRIPTREALLY').remove();
	str=(html.html().replace(/THISISNOTASCRIPTREALLY/g, 'script'));
	return str+" "+z
	}
	
	
function embedYT(str,size)
{
if(size=='big'){ytw=180;yth=145;vimw=200;vimh=122;}
else{ytw=150;yth=100;vimw=150;vimh=100}
if(str.indexOf("http://www.youtube.com")!=-1)
		{
		temp3=str.split("http://www.youtube.com/")
		temp4=temp3[1].split(" ")
		vidId=getYouTubeParameter("http://www.youtube.com/"+temp4[0], 'v');
		temp4.splice(0,1);temp4=temp4.join(" ");
		cont=temp3[0]+temp4
		str='<p></p>'
		return str;
		}
else if(str.indexOf("vimeo.com/")!=-1)
		{
		temp3=str.split("vimeo.com/")
		vidId=temp3[1]
		if(isNumber(vidId))
			{
			str='<br>'
			return str;
			}
		}
else{return str}
}
function isNumber(n) {
  return !isNaN(parseFloat(n)) && isFinite(n);
}
function getYouTubeParameter(url, name) {
    var urlparts = url.split('?');
    if (urlparts.length > 1) {
        var parameters = urlparts[1].split('&');
        for (var i = 0; i < parameters.length; i++) {
            var paramparts = parameters[i].split('=');
            if (paramparts.length > 1 && unescape(paramparts[0]) == name) {
                return unescape(paramparts[1]);
            }
        }
    }
    return null;
}


function printy()
{
$('#advert1').hide()
$('#advert2').hide()
$('#advert3').hide()
$('#advert4').hide()
$('#fixedRight').hide()
$('#addPostWrapper').hide()
window.print();
$('#advert1').show()
$('#advert2').show()
$('#advert3').show()
$('#advert4').show()
$('#addPostWrapper').show()
$('#addPostWrapper').show()
}


function embedIt()
		{
		if(templateType=="fresh"){apprise("Please SAVE your template first to get a unique URL for this Fakebook!");return}
		apprise($("#shareDivOptions").html())
		}
		
		function popup(s){
			$('.appriseOverlay').remove();$('.appriseOuter').remove()
			if(s=="QR")
				{
				apprise("<img src='http://chart.apis.google.com/chart?chs=250x250&amp;cht=qr&amp;chl=http%3A%2F%2Fwww.classtools.net%2FFB%2F1311-jUmjBH&amp;choe=UTF-8' alt='QR' />");
				}
			if(s=="widget")
				{
				apprise('<b>URL</b>: http://www.classtools.net/FB/1311-jUmjBH<p><b>Embed Code</b>:<br><textarea rows="10" cols="40"></textarea>');
				}
			}
		
		

//USEFUL FUNCTION FOR A CONTACT FORM WITHIN A PAGE.
function contactForm()
{
apprise("<iframe frameBorder='0' width='500px' height='200px' id='conForm' src='../_FAKEBOOK/contact/contactform.php' />",{'confirm' : true},
					function (e)
						{
						if(e){
							refe=self.location+"";
							brow=get_browser()+":"+get_browser_version()
										$.ajax({ url: "../_FAKEBOOK/contact/email.php",
											 data: {yn: yname, ye: yemail, ym: ymess, referrer:refe, brows:brow},
											 type: 'GET',
											 cache: false,
											 async:false,
											 success: function() {apprise("Email successfully sent.");}
											});
								}
						})
}


function get_browser(){
    var N=navigator.appName, ua=navigator.userAgent, tem;
    var M=ua.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);
    if(M && (tem= ua.match(/version\/([\.\d]+)/i))!= null) M[2]= tem[1];
    M=M? [M[1], M[2]]: [N, navigator.appVersion, '-?'];
    return M[0];
    }
function get_browser_version(){
    var N=navigator.appName, ua=navigator.userAgent, tem;
    var M=ua.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);
    if(M && (tem= ua.match(/version\/([\.\d]+)/i))!= null) M[2]= tem[1];
    M=M? [M[1], M[2]]: [N, navigator.appVersion, '-?'];
    return M[1];
    }

</script>	
		

<div style="display:none" id="shareDivOptions">
    <ul>
    <li><a href="javascript:popup('widget')">URL Link / Embed Code</a></li>
    <li><a href="javascript:popup('QR')">QR Code</a></li>
    <li><a href="http://www.classtools.net/_FAKEBOOK/download.php">Download Web Shortcut</a></li>
    
    </ul>
</div>
<div id="preloadQR" style="display:none"><img src="./message_files/chart" alt="QR"></div> 


<form name="deletetest" method="post" action="http://www.classtools.net/_FAKEBOOK/delete.php">
<input type="hidden" id="editingMode" name="editingMode" value="">
<input type="hidden" id="folders" name="folders" value="1311">
<input type="hidden" id="subfolders" name="subfolders" value="jUmjBH">
</form>

<div id="playGround" style="display:none">
               <div class="leftBox" data-intro="You can add blocks (e.g. &#39;friends&#39;, &#39;enemies&#39;, &#39;family&#39;) here" data-position="bottom">
               <img src="./message_files/delete.gif" class="deleteCross" id="cross">
                        <div class="leftBoxTitle">Friends (click here to change title)</div>
                        <br>
                        <span class="leftBoxElement"><img class="leftImg" src="./message_files/invis.gif"><span class="leftBoxText">type here</span></span>
                        <span class="leftBoxElement"><img class="leftImg" src="./message_files/invis.gif"><span class="leftBoxText">type here</span></span>
                        <span class="leftBoxElement"><img class="leftImg" src="./message_files/invis.gif"><span class="leftBoxText">type here</span></span>
                        <span class="leftBoxElement"><img class="leftImg" src="./message_files/invis.gif"><span class="leftBoxText">type here</span></span>
                        <span class="leftBoxElement"><img class="leftImg" src="./message_files/invis.gif"><span class="leftBoxText">type here</span></span>
                        <span class="leftBoxElement"><img class="leftImg" src="./message_files/invis.gif"><span class="leftBoxText">type here</span></span>
      			</div>
    </div><!-- use this for dumping temporary html to be manipulated by Jquery -->





<style>

html,body
{
margin: 0px;
}

.small
{
font-size:x-small;	
}

#loginBox
{
position:absolute;
z-index:10;
top:0px;
left:10px;	
color:black;
}

#login a:link {color:white;text-decoration:none; font-size:small;}
#login a:active{color:white;text-decoration:none}
#login a:visited{color:white;text-decoration:none}
#login
{
font-family:Verdana, Geneva, sans-serif;
z-index:9999;
font-size:small;
position:fixed;
top:0px;
left:0px;
width:100%;
text-align:left;
margin:0px;
background-color:#44619d;
text-decoration:none;
}

</style>
















<div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" style="display: none;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxLoadedContent" style="width: 0px; height: 0px; overflow: hidden; float: left;"></div><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><div id="cboxNext" style="float: left;"></div><div id="cboxPrevious" style="float: left;"></div><div id="cboxSlideshow" style="float: left;"></div><div id="cboxClose" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none;"></div></div><textarea tabindex="-1" style="position: absolute; top: -999px; left: 0px; right: auto; bottom: auto; border: 0px; box-sizing: content-box; word-wrap: break-word; overflow: hidden; transition: none; height: 0px !important; min-height: 0px !important; font-family: &#39;lucida grande&#39;, tahoma, verdana, arial, sans-serif; font-size: 13.3333330154419px; font-weight: 400; font-style: normal; letter-spacing: 0px; text-transform: none; word-spacing: 0px; text-indent: 0px; line-height: normal; width: 509.84375px;" class="autosizejs"></textarea><ul class="ui-autocomplete ui-front ui-menu ui-widget ui-widget-content ui-corner-all" id="ui-id-1" tabindex="0" style="display: none;"></ul><div class="appriseOverlay" id="aOverlay" style="height: 1615px; width: 1010px;"></div><div class="appriseOuter" style="left: 0px; top: 100px;"><div class="appriseInner"></div></div></body></html>
